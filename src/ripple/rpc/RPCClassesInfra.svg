<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1487px" preserveAspectRatio="none" style="width:2232px;height:1487px;" version="1.1" viewBox="0 0 2232 1487" width="2232px" zoomAndPan="magnify"><defs><filter height="300%" id="fxtr7tqnamkpm" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--class BasicApp--><rect fill="#FEFECE" filter="url(#fxtr7tqnamkpm)" height="73.6094" id="BasicApp" style="stroke: #A80036; stroke-width: 1.5;" width="208" x="368.5" y="173"/><ellipse cx="439.75" cy="189" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M442.7188,194.6406 Q442.1406,194.9375 441.5,195.0781 Q440.8594,195.2344 440.1563,195.2344 Q437.6563,195.2344 436.3281,193.5938 Q435.0156,191.9375 435.0156,188.8125 Q435.0156,185.6875 436.3281,184.0313 Q437.6563,182.375 440.1563,182.375 Q440.8594,182.375 441.5,182.5313 Q442.1563,182.6875 442.7188,182.9844 L442.7188,185.7031 Q442.0938,185.125 441.5,184.8594 Q440.9063,184.5781 440.2813,184.5781 Q438.9375,184.5781 438.25,185.6563 Q437.5625,186.7188 437.5625,188.8125 Q437.5625,190.9063 438.25,191.9844 Q438.9375,193.0469 440.2813,193.0469 Q440.9063,193.0469 441.5,192.7813 Q442.0938,192.5 442.7188,191.9219 L442.7188,194.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="57" x="460.25" y="193.1543">BasicApp</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="369.5" x2="575.5" y1="205" y2="205"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="196" x="374.5" y="219.2104">std::vector&lt;std::thread&gt; threads_</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="196" x="374.5" y="232.0151">boost::asio::io_service io_service_</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="369.5" x2="575.5" y1="238.6094" y2="238.6094"/><!--class ApplicationImpl--><rect fill="#FEFECE" filter="url(#fxtr7tqnamkpm)" height="99.2188" id="ApplicationImpl" style="stroke: #A80036; stroke-width: 1.5;" width="300" x="322.5" y="313"/><ellipse cx="421.25" cy="329" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M424.2188,334.6406 Q423.6406,334.9375 423,335.0781 Q422.3594,335.2344 421.6563,335.2344 Q419.1563,335.2344 417.8281,333.5938 Q416.5156,331.9375 416.5156,328.8125 Q416.5156,325.6875 417.8281,324.0313 Q419.1563,322.375 421.6563,322.375 Q422.3594,322.375 423,322.5313 Q423.6563,322.6875 424.2188,322.9844 L424.2188,325.7031 Q423.5938,325.125 423,324.8594 Q422.4063,324.5781 421.7813,324.5781 Q420.4375,324.5781 419.75,325.6563 Q419.0625,326.7188 419.0625,328.8125 Q419.0625,330.9063 419.75,331.9844 Q420.4375,333.0469 421.7813,333.0469 Q422.4063,333.0469 423,332.7813 Q423.5938,332.5 424.2188,331.9219 L424.2188,334.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="94" x="441.75" y="333.1543">ApplicationImpl</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="323.5" x2="621.5" y1="345" y2="345"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="233" x="328.5" y="359.2104">std::unique_ptr&lt;JobQueue&gt; m_jobQueue</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="262" x="328.5" y="372.0151">std::unique_ptr&lt;NetworkOPs&gt; m_networkOPs</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="288" x="328.5" y="384.8198">std::unique_ptr&lt;ServerHandler&gt; m_serverHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="323.5" x2="621.5" y1="391.4141" y2="391.4141"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="67" x="328.5" y="405.6245">void setup()</text><!--class ServerHandler--><rect fill="#FEFECE" filter="url(#fxtr7tqnamkpm)" height="48" id="ServerHandler" style="stroke: #A80036; stroke-width: 1.5;" width="121" x="657" y="338.5"/><ellipse cx="672" cy="354.5" fill="#A9DCDF" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M672.1094,349.8438 L670.9531,354.9219 L673.2813,354.9219 L672.1094,349.8438 Z M670.625,347.6094 L673.6094,347.6094 L676.9688,360 L674.5156,360 L673.75,356.9375 L670.4688,356.9375 L669.7188,360 L667.2813,360 L670.625,347.6094 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="89" x="686" y="358.6543">ServerHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="658" x2="777" y1="370.5" y2="370.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="658" x2="777" y1="378.5" y2="378.5"/><!--class ServerHandlerImpl--><rect fill="#FEFECE" filter="url(#fxtr7tqnamkpm)" height="188.8516" id="ServerHandlerImpl" style="stroke: #A80036; stroke-width: 1.5;" width="212" x="589.5" y="472"/><ellipse cx="634.25" cy="488" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M637.2188,493.6406 Q636.6406,493.9375 636,494.0781 Q635.3594,494.2344 634.6563,494.2344 Q632.1563,494.2344 630.8281,492.5938 Q629.5156,490.9375 629.5156,487.8125 Q629.5156,484.6875 630.8281,483.0313 Q632.1563,481.375 634.6563,481.375 Q635.3594,481.375 636,481.5313 Q636.6563,481.6875 637.2188,481.9844 L637.2188,484.7031 Q636.5938,484.125 636,483.8594 Q635.4063,483.5781 634.7813,483.5781 Q633.4375,483.5781 632.75,484.6563 Q632.0625,485.7188 632.0625,487.8125 Q632.0625,489.9063 632.75,490.9844 Q633.4375,492.0469 634.7813,492.0469 Q635.4063,492.0469 636,491.7813 Q636.5938,491.5 637.2188,490.9219 L637.2188,493.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="114" x="654.75" y="492.1543">ServerHandlerImpl</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="590.5" x2="800.5" y1="504" y2="504"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="168" x="595.5" y="518.2104">NetworkOPs&amp; m_networkOPs</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="139" x="595.5" y="531.0151">JobQueue&amp; m_jobQueue</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="200" x="595.5" y="543.8198">std::unique_ptr&lt;Server&gt; m_server</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="590.5" x2="800.5" y1="550.4141" y2="550.4141"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="40" x="595.5" y="564.6245">setup()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="59" x="595.5" y="577.4292">onAccept()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="66" x="595.5" y="590.2339">onHandoff()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="68" x="595.5" y="603.0386">onRequest()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="90" x="595.5" y="615.8433">onWSMessage()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="100" x="595.5" y="628.6479">processSession()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="100" x="595.5" y="641.4526">processRequest()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="48" x="595.5" y="654.2573">onStop()</text><!--class Server--><rect fill="#FEFECE" filter="url(#fxtr7tqnamkpm)" height="48" id="Server" style="stroke: #A80036; stroke-width: 1.5;" width="72" x="1119.5" y="542.5"/><ellipse cx="1134.5" cy="558.5" fill="#A9DCDF" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1134.6094,553.8438 L1133.4531,558.9219 L1135.7813,558.9219 L1134.6094,553.8438 Z M1133.125,551.6094 L1136.1094,551.6094 L1139.4688,564 L1137.0156,564 L1136.25,560.9375 L1132.9688,560.9375 L1132.2188,564 L1129.7813,564 L1133.125,551.6094 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="40" x="1148.5" y="562.6543">Server</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1120.5" x2="1190.5" y1="574.5" y2="574.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1120.5" x2="1190.5" y1="582.5" y2="582.5"/><!--class Stoppable--><rect fill="#FEFECE" filter="url(#fxtr7tqnamkpm)" height="99.2188" id="Stoppable" style="stroke: #A80036; stroke-width: 1.5;" width="142" x="701.5" y="8"/><ellipse cx="737.2" cy="24" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M740.1688,29.6406 Q739.5906,29.9375 738.95,30.0781 Q738.3094,30.2344 737.6063,30.2344 Q735.1063,30.2344 733.7781,28.5938 Q732.4656,26.9375 732.4656,23.8125 Q732.4656,20.6875 733.7781,19.0313 Q735.1063,17.375 737.6063,17.375 Q738.3094,17.375 738.95,17.5313 Q739.6063,17.6875 740.1688,17.9844 L740.1688,20.7031 Q739.5438,20.125 738.95,19.8594 Q738.3563,19.5781 737.7313,19.5781 Q736.3875,19.5781 735.7,20.6563 Q735.0125,21.7188 735.0125,23.8125 Q735.0125,25.9063 735.7,26.9844 Q736.3875,28.0469 737.7313,28.0469 Q738.3563,28.0469 738.95,27.7813 Q739.5438,27.5 740.1688,26.9219 L740.1688,29.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="64" x="755.8" y="28.1543">Stoppable</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="702.5" x2="842.5" y1="40" y2="40"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="702.5" x2="842.5" y1="48" y2="48"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="130" x="707.5" y="62.2104">setParent(Stoppable&amp;)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="50" x="707.5" y="75.0151">onStart()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="69" x="707.5" y="87.8198">onStopped()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="116" x="707.5" y="100.6245">onChildrenStopped()</text><!--class RootStoppable--><rect fill="#FEFECE" filter="url(#fxtr7tqnamkpm)" height="86.4141" id="RootStoppable" style="stroke: #A80036; stroke-width: 1.5;" width="125" x="632" y="167"/><ellipse cx="647" cy="183" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M649.9688,188.6406 Q649.3906,188.9375 648.75,189.0781 Q648.1094,189.2344 647.4063,189.2344 Q644.9063,189.2344 643.5781,187.5938 Q642.2656,185.9375 642.2656,182.8125 Q642.2656,179.6875 643.5781,178.0313 Q644.9063,176.375 647.4063,176.375 Q648.1094,176.375 648.75,176.5313 Q649.4063,176.6875 649.9688,176.9844 L649.9688,179.7031 Q649.3438,179.125 648.75,178.8594 Q648.1563,178.5781 647.5313,178.5781 Q646.1875,178.5781 645.5,179.6563 Q644.8125,180.7188 644.8125,182.8125 Q644.8125,184.9063 645.5,185.9844 Q646.1875,187.0469 647.5313,187.0469 Q648.1563,187.0469 648.75,186.7813 Q649.3438,186.5 649.9688,185.9219 L649.9688,188.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="93" x="661" y="187.1543">RootStoppable</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="633" x2="756" y1="199" y2="199"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="633" x2="756" y1="207" y2="207"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="638" y="221.2104">start()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="33" x="638" y="234.0151">stop()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="66" x="638" y="246.8198">stopAsync()</text><!--class InfoSub::Source--><rect fill="#FEFECE" filter="url(#fxtr7tqnamkpm)" height="48" id="InfoSub::Source" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="862.5" y="1237"/><ellipse cx="877.5" cy="1253" fill="#A9DCDF" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M877.6094,1248.3438 L876.4531,1253.4219 L878.7813,1253.4219 L877.6094,1248.3438 Z M876.125,1246.1094 L879.1094,1246.1094 L882.4688,1258.5 L880.0156,1258.5 L879.25,1255.4375 L875.9688,1255.4375 L875.2188,1258.5 L872.7813,1258.5 L876.125,1246.1094 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="100" x="891.5" y="1257.1543">InfoSub::Source</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="863.5" x2="993.5" y1="1269" y2="1269"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="863.5" x2="993.5" y1="1277" y2="1277"/><!--class JobQueue--><rect fill="#FEFECE" filter="url(#fxtr7tqnamkpm)" height="112.0234" id="JobQueue" style="stroke: #A80036; stroke-width: 1.5;" width="148" x="281.5" y="1027"/><ellipse cx="321.7" cy="1043" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M324.6688,1048.6406 Q324.0906,1048.9375 323.45,1049.0781 Q322.8094,1049.2344 322.1063,1049.2344 Q319.6063,1049.2344 318.2781,1047.5938 Q316.9656,1045.9375 316.9656,1042.8125 Q316.9656,1039.6875 318.2781,1038.0313 Q319.6063,1036.375 322.1063,1036.375 Q322.8094,1036.375 323.45,1036.5313 Q324.1063,1036.6875 324.6688,1036.9844 L324.6688,1039.7031 Q324.0438,1039.125 323.45,1038.8594 Q322.8563,1038.5781 322.2313,1038.5781 Q320.8875,1038.5781 320.2,1039.6563 Q319.5125,1040.7188 319.5125,1042.8125 Q319.5125,1044.9063 320.2,1045.9844 Q320.8875,1047.0469 322.2313,1047.0469 Q322.8563,1047.0469 323.45,1046.7813 Q324.0438,1046.5 324.6688,1045.9219 L324.6688,1048.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="60" x="341.3" y="1047.1543">JobQueue</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="282.5" x2="428.5" y1="1059" y2="1059"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="113" x="287.5" y="1073.2104">Workers m_workers</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="136" x="287.5" y="1086.0151">std::set&lt;Job&gt; m_jobSet</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="282.5" x2="428.5" y1="1092.6094" y2="1092.6094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="287.5" y="1106.8198">setThreadCount()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="46" x="287.5" y="1119.6245">addJob()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="60" x="287.5" y="1132.4292">postCoro()</text><!--class Job--><rect fill="#FEFECE" filter="url(#fxtr7tqnamkpm)" height="86.4141" id="Job" style="stroke: #A80036; stroke-width: 1.5;" width="191" x="6" y="1218"/><ellipse cx="87.75" cy="1234" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M90.7188,1239.6406 Q90.1406,1239.9375 89.5,1240.0781 Q88.8594,1240.2344 88.1563,1240.2344 Q85.6563,1240.2344 84.3281,1238.5938 Q83.0156,1236.9375 83.0156,1233.8125 Q83.0156,1230.6875 84.3281,1229.0313 Q85.6563,1227.375 88.1563,1227.375 Q88.8594,1227.375 89.5,1227.5313 Q90.1563,1227.6875 90.7188,1227.9844 L90.7188,1230.7031 Q90.0938,1230.125 89.5,1229.8594 Q88.9063,1229.5781 88.2813,1229.5781 Q86.9375,1229.5781 86.25,1230.6563 Q85.5625,1231.7188 85.5625,1233.8125 Q85.5625,1235.9063 86.25,1236.9844 Q86.9375,1238.0469 88.2813,1238.0469 Q88.9063,1238.0469 89.5,1237.7813 Q90.0938,1237.5 90.7188,1236.9219 L90.7188,1239.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="19" x="108.25" y="1238.1543">Job</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="196" y1="1250" y2="1250"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="86" x="12" y="1264.2104">JobType mType</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="196" y1="1270.8047" y2="1270.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="39" x="12" y="1285.0151">doJob()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="179" x="12" y="1297.8198">std::function&lt;void(Job&amp;)&gt; mJob</text><!--class Worker--><rect fill="#FEFECE" filter="url(#fxtr7tqnamkpm)" height="112.0234" id="Worker" style="stroke: #A80036; stroke-width: 1.5;" width="193" x="267" y="1364"/><ellipse cx="337.25" cy="1380" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M340.2188,1385.6406 Q339.6406,1385.9375 339,1386.0781 Q338.3594,1386.2344 337.6563,1386.2344 Q335.1563,1386.2344 333.8281,1384.5938 Q332.5156,1382.9375 332.5156,1379.8125 Q332.5156,1376.6875 333.8281,1375.0313 Q335.1563,1373.375 337.6563,1373.375 Q338.3594,1373.375 339,1373.5313 Q339.6563,1373.6875 340.2188,1373.9844 L340.2188,1376.7031 Q339.5938,1376.125 339,1375.8594 Q338.4063,1375.5781 337.7813,1375.5781 Q336.4375,1375.5781 335.75,1376.6563 Q335.0625,1377.7188 335.0625,1379.8125 Q335.0625,1381.9063 335.75,1382.9844 Q336.4375,1384.0469 337.7813,1384.0469 Q338.4063,1384.0469 339,1383.7813 Q339.5938,1383.5 340.2188,1382.9219 L340.2188,1385.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="44" x="357.75" y="1384.1543">Worker</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="268" x2="459" y1="1396" y2="1396"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="273" y="1410.2104">std:thread thread_</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="273" y="1423.0151">std::mutex mutex_</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="181" x="273" y="1435.8198">std::condition_variable wakeup_</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="268" x2="459" y1="1442.4141" y2="1442.4141"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="39" x="273" y="1456.6245">notify()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="27" x="273" y="1469.4292">run()</text><!--class Workers--><rect fill="#FEFECE" filter="url(#fxtr7tqnamkpm)" height="86.4141" id="Workers" style="stroke: #A80036; stroke-width: 1.5;" width="263" x="232" y="1218"/><ellipse cx="333.75" cy="1234" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M336.7188,1239.6406 Q336.1406,1239.9375 335.5,1240.0781 Q334.8594,1240.2344 334.1563,1240.2344 Q331.6563,1240.2344 330.3281,1238.5938 Q329.0156,1236.9375 329.0156,1233.8125 Q329.0156,1230.6875 330.3281,1229.0313 Q331.6563,1227.375 334.1563,1227.375 Q334.8594,1227.375 335.5,1227.5313 Q336.1563,1227.6875 336.7188,1227.9844 L336.7188,1230.7031 Q336.0938,1230.125 335.5,1229.8594 Q334.9063,1229.5781 334.2813,1229.5781 Q332.9375,1229.5781 332.25,1230.6563 Q331.5625,1231.7188 331.5625,1233.8125 Q331.5625,1235.9063 332.25,1236.9844 Q332.9375,1238.0469 334.2813,1238.0469 Q334.9063,1238.0469 335.5,1237.7813 Q336.0938,1237.5 336.7188,1236.9219 L336.7188,1239.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="51" x="354.25" y="1238.1543">Workers</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="233" x2="494" y1="1250" y2="1250"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="251" x="238" y="1264.2104">beast::LockFreeStack&lt;Worker&gt; m_everyone</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="151" x="238" y="1277.0151">semaphore m_semaphore</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="233" x2="494" y1="1283.6094" y2="1283.6094"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="56" x="238" y="1297.8198">addTask()</text><!--class NetworkOPsImp--><rect fill="#FEFECE" filter="url(#fxtr7tqnamkpm)" height="227.2656" id="NetworkOPsImp" style="stroke: #A80036; stroke-width: 1.5;" width="417" x="465" y="721"/><ellipse cx="620.75" cy="737" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M623.7188,742.6406 Q623.1406,742.9375 622.5,743.0781 Q621.8594,743.2344 621.1563,743.2344 Q618.6563,743.2344 617.3281,741.5938 Q616.0156,739.9375 616.0156,736.8125 Q616.0156,733.6875 617.3281,732.0313 Q618.6563,730.375 621.1563,730.375 Q621.8594,730.375 622.5,730.5313 Q623.1563,730.6875 623.7188,730.9844 L623.7188,733.7031 Q623.0938,733.125 622.5,732.8594 Q621.9063,732.5781 621.2813,732.5781 Q619.9375,732.5781 619.25,733.6563 Q618.5625,734.7188 618.5625,736.8125 Q618.5625,738.9063 619.25,739.9844 Q619.9375,741.0469 621.2813,741.0469 Q621.9063,741.0469 622.5,740.7813 Q623.0938,740.5 623.7188,739.9219 L623.7188,742.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="97" x="641.25" y="741.1543">NetworkOPsImp</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="466" x2="881" y1="753" y2="753"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="405" x="471" y="767.2104">using SubMapType = hash_map&lt;std::uint64_t,std::weak_ptr&lt;InfoSub&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="244" x="471" y="780.0151">std::array&lt;SubMapType,8&gt; mStreamMaps</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="293" x="471" y="792.8198">hash_map&lt;AccountID, SubMapType&gt; mSubAccount</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="307" x="471" y="805.6245">hash_map&lt;AccountID, SubMapType&gt; mSubRTAccount</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="466" x2="881" y1="812.2188" y2="812.2188"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="121" x="471" y="826.4292">processTransaction()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="68" x="471" y="839.2339">pubLedger()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="148" x="471" y="852.0386">pubValidatedTransaction()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="140" x="471" y="864.8433">pubAccountTransaction()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="217" x="471" y="877.6479">subLedger(std::shared_ptr&lt;InfoSub&gt;)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="153" x="471" y="890.4526">unsubLedger(std::uint64_t)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="252" x="471" y="903.2573">subTransactions(std::shared_ptr&lt;InfoSub&gt;)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="188" x="471" y="916.062">unsubTransactions(std::uint64_t)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="355" x="471" y="928.8667">subAccount(std::shared_ptr&lt;InfoSub&gt;, hash_set&lt;AccountID&gt;)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="369" x="471" y="941.6714">unsubAccount(std::shared_ptr&lt;InfoSub&gt;, hash_set&lt;AccountID&gt;)</text><!--class ServerImpl<Handler>--><rect fill="#FEFECE" filter="url(#fxtr7tqnamkpm)" height="137.6328" id="ServerImpl&lt;Handler&gt;" style="stroke: #A80036; stroke-width: 1.5;" width="293" x="1009" y="765.5"/><ellipse cx="1084.25" cy="781.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1087.2188,787.1406 Q1086.6406,787.4375 1086,787.5781 Q1085.3594,787.7344 1084.6563,787.7344 Q1082.1563,787.7344 1080.8281,786.0938 Q1079.5156,784.4375 1079.5156,781.3125 Q1079.5156,778.1875 1080.8281,776.5313 Q1082.1563,774.875 1084.6563,774.875 Q1085.3594,774.875 1086,775.0313 Q1086.6563,775.1875 1087.2188,775.4844 L1087.2188,778.2031 Q1086.5938,777.625 1086,777.3594 Q1085.4063,777.0781 1084.7813,777.0781 Q1083.4375,777.0781 1082.75,778.1563 Q1082.0625,779.2188 1082.0625,781.3125 Q1082.0625,783.4063 1082.75,784.4844 Q1083.4375,785.5469 1084.7813,785.5469 Q1085.4063,785.5469 1086,785.2813 Q1086.5938,785 1087.2188,784.4219 L1087.2188,787.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="134" x="1104.75" y="785.6543">ServerImpl&lt;Handler&gt;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1010" x2="1301" y1="797.5" y2="797.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="206" x="1015" y="811.7104">boost::asio::io_service&amp; io_service_</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="221" x="1015" y="824.5151">boost::asio::io_service::strand strand_</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="107" x="1015" y="837.3198">Handler&amp; handler_</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="281" x="1015" y="850.1245">std::vector&lt;std::weak_ptr&lt;Door&lt;Handler&gt;&gt; list_</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="60" x="1015" y="862.9292">io_list ios_</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1010" x2="1301" y1="869.5234" y2="869.5234"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="38" x="1015" y="883.7339">ports()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="38" x="1015" y="896.5386">close()</text><!--class io_list--><rect fill="#FEFECE" filter="url(#fxtr7tqnamkpm)" height="99.2188" id="io_list" style="stroke: #A80036; stroke-width: 1.5;" width="378" x="1652.5" y="1033.5"/><ellipse cx="1819.75" cy="1049.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1822.7188,1055.1406 Q1822.1406,1055.4375 1821.5,1055.5781 Q1820.8594,1055.7344 1820.1563,1055.7344 Q1817.6563,1055.7344 1816.3281,1054.0938 Q1815.0156,1052.4375 1815.0156,1049.3125 Q1815.0156,1046.1875 1816.3281,1044.5313 Q1817.6563,1042.875 1820.1563,1042.875 Q1820.8594,1042.875 1821.5,1043.0313 Q1822.1563,1043.1875 1822.7188,1043.4844 L1822.7188,1046.2031 Q1822.0938,1045.625 1821.5,1045.3594 Q1820.9063,1045.0781 1820.2813,1045.0781 Q1818.9375,1045.0781 1818.25,1046.1563 Q1817.5625,1047.2188 1817.5625,1049.3125 Q1817.5625,1051.4063 1818.25,1052.4844 Q1818.9375,1053.5469 1820.2813,1053.5469 Q1820.9063,1053.5469 1821.5,1053.2813 Q1822.0938,1053 1822.7188,1052.4219 L1822.7188,1055.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="35" x="1840.25" y="1053.6543">io_list</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1653.5" x2="2029.5" y1="1065.5" y2="1065.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="366" x="1658.5" y="1079.7104">boost::container::flat_map&lt;work*, std::weak_ptr&lt;work&gt;&gt; map_</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1653.5" x2="2029.5" y1="1086.3047" y2="1086.3047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="56" x="1658.5" y="1100.5151">emplace()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="38" x="1658.5" y="1113.3198">close()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="1658.5" y="1126.1245">join()</text><!--class io_list::work--><rect fill="#FEFECE" filter="url(#fxtr7tqnamkpm)" height="86.4141" id="io_list::work" style="stroke: #A80036; stroke-width: 1.5;" width="104" x="1608.5" y="791.5"/><ellipse cx="1623.5" cy="807.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1626.4688,813.1406 Q1625.8906,813.4375 1625.25,813.5781 Q1624.6094,813.7344 1623.9063,813.7344 Q1621.4063,813.7344 1620.0781,812.0938 Q1618.7656,810.4375 1618.7656,807.3125 Q1618.7656,804.1875 1620.0781,802.5313 Q1621.4063,800.875 1623.9063,800.875 Q1624.6094,800.875 1625.25,801.0313 Q1625.9063,801.1875 1626.4688,801.4844 L1626.4688,804.2031 Q1625.8438,803.625 1625.25,803.3594 Q1624.6563,803.0781 1624.0313,803.0781 Q1622.6875,803.0781 1622,804.1563 Q1621.3125,805.2188 1621.3125,807.3125 Q1621.3125,809.4063 1622,810.4844 Q1622.6875,811.5469 1624.0313,811.5469 Q1624.6563,811.5469 1625.25,811.2813 Q1625.8438,811 1626.4688,810.4219 L1626.4688,813.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="72" x="1637.5" y="811.6543">io_list::work</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1609.5" x2="1711.5" y1="823.5" y2="823.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="66" x="1614.5" y="837.7104">io_list* ios_</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1609.5" x2="1711.5" y1="844.3047" y2="844.3047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="72" x="1614.5" y="858.5151">io_list&amp; ios()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="62" x="1614.5" y="871.3198">close() = 0</text><!--class Door<Handler>--><rect fill="#FEFECE" filter="url(#fxtr7tqnamkpm)" height="137.6328" id="Door&lt;Handler&gt;" style="stroke: #A80036; stroke-width: 1.5;" width="233" x="1075" y="1014"/><ellipse cx="1137.75" cy="1030" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1140.7188,1035.6406 Q1140.1406,1035.9375 1139.5,1036.0781 Q1138.8594,1036.2344 1138.1563,1036.2344 Q1135.6563,1036.2344 1134.3281,1034.5938 Q1133.0156,1032.9375 1133.0156,1029.8125 Q1133.0156,1026.6875 1134.3281,1025.0313 Q1135.6563,1023.375 1138.1563,1023.375 Q1138.8594,1023.375 1139.5,1023.5313 Q1140.1563,1023.6875 1140.7188,1023.9844 L1140.7188,1026.7031 Q1140.0938,1026.125 1139.5,1025.8594 Q1138.9063,1025.5781 1138.2813,1025.5781 Q1136.9375,1025.5781 1136.25,1026.6563 Q1135.5625,1027.7188 1135.5625,1029.8125 Q1135.5625,1031.9063 1136.25,1032.9844 Q1136.9375,1034.0469 1138.2813,1034.0469 Q1138.9063,1034.0469 1139.5,1033.7813 Q1140.0938,1033.5 1140.7188,1032.9219 L1140.7188,1035.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="99" x="1158.25" y="1034.1543">Door&lt;Handler&gt;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1076" x2="1307" y1="1046" y2="1046"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="165" x="1081" y="1060.2104">boost::asio::io_service&amp; ioc_</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="221" x="1081" y="1073.0151">boost::asio::io_service::strand strand_</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="107" x="1081" y="1085.8198">Handler&amp; handler_</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="219" x="1081" y="1098.6245">boost::asio:ip::tcp::acceptor acceptor_</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1076" x2="1307" y1="1105.2188" y2="1105.2188"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="27" x="1081" y="1119.4292">run()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="38" x="1081" y="1132.2339">close()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="65" x="1081" y="1145.0386">do_accept()</text><!--class Door<Handler>::Detector--><rect fill="#FEFECE" filter="url(#fxtr7tqnamkpm)" height="150.4375" id="Door&lt;Handler&gt;::Detector" style="stroke: #A80036; stroke-width: 1.5;" width="274" x="1343.5" y="1008"/><ellipse cx="1395.25" cy="1024" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1398.2188,1029.6406 Q1397.6406,1029.9375 1397,1030.0781 Q1396.3594,1030.2344 1395.6563,1030.2344 Q1393.1563,1030.2344 1391.8281,1028.5938 Q1390.5156,1026.9375 1390.5156,1023.8125 Q1390.5156,1020.6875 1391.8281,1019.0313 Q1393.1563,1017.375 1395.6563,1017.375 Q1396.3594,1017.375 1397,1017.5313 Q1397.6563,1017.6875 1398.2188,1017.9844 L1398.2188,1020.7031 Q1397.5938,1020.125 1397,1019.8594 Q1396.4063,1019.5781 1395.7813,1019.5781 Q1394.4375,1019.5781 1393.75,1020.6563 Q1393.0625,1021.7188 1393.0625,1023.8125 Q1393.0625,1025.9063 1393.75,1026.9844 Q1394.4375,1028.0469 1395.7813,1028.0469 Q1396.4063,1028.0469 1397,1027.7813 Q1397.5938,1027.5 1398.2188,1026.9219 L1398.2188,1029.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="162" x="1415.75" y="1028.1543">Door&lt;Handler&gt;::Detector</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1344.5" x2="1616.5" y1="1040" y2="1040"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="165" x="1349.5" y="1054.2104">boost::asio::io_service&amp; ioc_</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="231" x="1349.5" y="1067.0151">boost::asio::io_service::strand&amp; strand_</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="107" x="1349.5" y="1079.8198">Handler&amp; handler_</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="199" x="1349.5" y="1092.6245">boost::asio::ip::tcp::socket socket_</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="262" x="1349.5" y="1105.4292">boost::asio::ip::tcp::endpoint remote_address</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1344.5" x2="1616.5" y1="1112.0234" y2="1112.0234"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="27" x="1349.5" y="1126.2339">run()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="38" x="1349.5" y="1139.0386">close()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="63" x="1349.5" y="1151.8433">do_detect()</text><!--class NetworkOPs--><rect fill="#FEFECE" filter="url(#fxtr7tqnamkpm)" height="48" id="NetworkOPs" style="stroke: #A80036; stroke-width: 1.5;" width="105" x="701" y="1396"/><ellipse cx="716" cy="1412" fill="#A9DCDF" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M716.1094,1407.3438 L714.9531,1412.4219 L717.2813,1412.4219 L716.1094,1407.3438 Z M714.625,1405.1094 L717.6094,1405.1094 L720.9688,1417.5 L718.5156,1417.5 L717.75,1414.4375 L714.4688,1414.4375 L713.7188,1417.5 L711.2813,1417.5 L714.625,1405.1094 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="73" x="730" y="1416.1543">NetworkOPs</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="702" x2="805" y1="1428" y2="1428"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="702" x2="805" y1="1436" y2="1436"/><!--class InfoSub--><rect fill="#FEFECE" filter="url(#fxtr7tqnamkpm)" height="124.8281" id="InfoSub" style="stroke: #A80036; stroke-width: 1.5;" width="197" x="632" y="1020.5"/><ellipse cx="702.75" cy="1036.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M705.7188,1042.1406 Q705.1406,1042.4375 704.5,1042.5781 Q703.8594,1042.7344 703.1563,1042.7344 Q700.6563,1042.7344 699.3281,1041.0938 Q698.0156,1039.4375 698.0156,1036.3125 Q698.0156,1033.1875 699.3281,1031.5313 Q700.6563,1029.875 703.1563,1029.875 Q703.8594,1029.875 704.5,1030.0313 Q705.1563,1030.1875 705.7188,1030.4844 L705.7188,1033.2031 Q705.0938,1032.625 704.5,1032.3594 Q703.9063,1032.0781 703.2813,1032.0781 Q701.9375,1032.0781 701.25,1033.1563 Q700.5625,1034.2188 700.5625,1036.3125 Q700.5625,1038.4063 701.25,1039.4844 Q701.9375,1040.5469 703.2813,1040.5469 Q703.9063,1040.5469 704.5,1040.2813 Q705.0938,1040 705.7188,1039.4219 L705.7188,1042.1406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="47" x="723.25" y="1040.6543">InfoSub</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="633" x2="828" y1="1052.5" y2="1052.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="161" x="638" y="1066.7104">InfoSub::Source&amp; m_source</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="633" x2="828" y1="1073.3047" y2="1073.3047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="123" x="638" y="1087.5151">std::uint64_t getSeq()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="172" x="638" y="1100.3198">static std::uint64_t assign_id()</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="183" x="638" y="1113.1245">insertSubAccountInfo(AccountID)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="185" x="638" y="1125.9292">deleteSubAccountInfo(AccountID)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="60" x="638" y="1138.7339">send() = 0</text><!--class WSInfoSub--><rect fill="#FEFECE" filter="url(#fxtr7tqnamkpm)" height="73.6094" id="WSInfoSub" style="stroke: #A80036; stroke-width: 1.5;" width="196" x="631.5" y="1224"/><ellipse cx="692.25" cy="1240" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M695.2188,1245.6406 Q694.6406,1245.9375 694,1246.0781 Q693.3594,1246.2344 692.6563,1246.2344 Q690.1563,1246.2344 688.8281,1244.5938 Q687.5156,1242.9375 687.5156,1239.8125 Q687.5156,1236.6875 688.8281,1235.0313 Q690.1563,1233.375 692.6563,1233.375 Q693.3594,1233.375 694,1233.5313 Q694.6563,1233.6875 695.2188,1233.9844 L695.2188,1236.7031 Q694.5938,1236.125 694,1235.8594 Q693.4063,1235.5781 692.7813,1235.5781 Q691.4375,1235.5781 690.75,1236.6563 Q690.0625,1237.7188 690.0625,1239.8125 Q690.0625,1241.9063 690.75,1242.9844 Q691.4375,1244.0469 692.7813,1244.0469 Q693.4063,1244.0469 694,1243.7813 Q694.5938,1243.5 695.2188,1242.9219 L695.2188,1245.6406 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="66" x="712.75" y="1244.1543">WSInfoSub</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="632.5" x2="826.5" y1="1256" y2="1256"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="184" x="637.5" y="1270.2104">std::weak_ptr&lt;WSSession&gt; ws_</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="632.5" x2="826.5" y1="1276.8047" y2="1276.8047"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="36" x="637.5" y="1291.0151">send()</text><polygon fill="#FBFB77" filter="url(#fxtr7tqnamkpm)" points="1029.5,1248.5,1029.5,1273.6328,1371.5,1273.6328,1371.5,1258.5,1361.5,1248.5,1029.5,1248.5" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1361.5" x2="1361.5" y1="1248.5" y2="1258.5"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1371.5" x2="1361.5" y1="1258.5" y2="1258.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="321" x="1035.5" y="1265.5669">Handler template parameter is ServerHandlerImpl</text><polygon fill="#FBFB77" filter="url(#fxtr7tqnamkpm)" points="1715,1241,1715,1281.2656,2210,1281.2656,2210,1251,2200,1241,1715,1241" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2200" x2="2200" y1="1241" y2="1251"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2210" x2="2200" y1="1251" y2="1251"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="374" x="1721" y="1258.0669">io_list keeps a collection of pointers to io_list::work objects,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="474" x="1721" y="1273.1997">while the io_list::work objects have a pointer to the containing io_list object</text><!--link BasicApp to ApplicationImpl--><path d="M472.5,267.4918 C472.5,282.4377 472.5,298.4088 472.5,312.9086 " fill="none" id="BasicApp-ApplicationImpl" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="465.5001,267.3057,472.5,247.3057,479.5001,267.3057,465.5001,267.3057" style="stroke: #A80036; stroke-width: 1.0;"/><!--link ServerHandler to ServerHandlerImpl--><path d="M712.7388,406.6491 C710.6793,425.7461 708.1839,448.8852 705.7389,471.5571 " fill="none" id="ServerHandler-ServerHandlerImpl" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="705.7858,405.8367,714.8899,386.7026,719.705,407.3379,705.7858,405.8367" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Stoppable to RootStoppable--><path d="M737.8613,125.2231 C730.6222,139.3765 723.18,153.9269 716.5495,166.8904 " fill="none" id="Stoppable-RootStoppable" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="731.8361,121.6309,747.1756,107.0124,744.3003,128.0061,731.8361,121.6309" style="stroke: #A80036; stroke-width: 1.0;"/><!--link RootStoppable to ApplicationImpl--><path d="M615.1064,264.5384 C592.1964,280.2761 567.3267,297.3601 544.8677,312.7879 " fill="none" id="RootStoppable-ApplicationImpl" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="611.3252,258.6434,631.7739,253.0889,619.2522,270.183,611.3252,258.6434" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Stoppable to ServerHandlerImpl--><path d="M790.9361,126.8594 C807.049,199.4889 823.8262,316.1048 795.5,412 C789.4356,432.5303 779.6959,452.8971 768.62,471.7796 " fill="none" id="Stoppable-ServerHandlerImpl" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="784.0643,128.2142,786.3377,107.1468,797.6982,125.0337,784.0643,128.2142" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Stoppable to InfoSub::Source--><path d="M831.5916,122.7345 C878.2368,181.1436 935.5,271.4005 935.5,362.5 C935.5,362.5 935.5,362.5 935.5,834.5 C935.5,987.7941 930.9232,1172.0388 929.1712,1236.9538 " fill="none" id="Stoppable-InfoSub::Source" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="826.0595,127.028,818.7733,107.1305,836.8775,118.1413,826.0595,127.028" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Stoppable to JobQueue--><path d="M681.6157,71.3755 C572.9515,89.5883 399.5725,124.3112 350.5,167 C279.5405,228.7287 269.5,268.4485 269.5,362.5 C269.5,362.5 269.5,362.5 269.5,566.5 C269.5,736.0372 315.1432,932.678 339.926,1026.9523 " fill="none" id="Stoppable-JobQueue" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="680.5674,64.4539,701.4383,68.1154,682.8394,78.2683,680.5674,64.4539" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Workers to Worker--><path d="M363.5,1317.4394 C363.5,1332.4885 363.5,1348.7445 363.5,1363.7817 " fill="none" id="Workers-Worker" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="363.5,1304.0277,359.5,1310.0277,363.5,1316.0277,367.5,1310.0277,363.5,1304.0277" style="stroke: #A80036; stroke-width: 1.0;"/><!--link JobQueue to Workers--><path d="M358.6191,1152.4006 C359.6086,1174.4164 360.6737,1198.1159 361.5558,1217.7408 " fill="none" id="JobQueue-Workers" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="358.0313,1139.3203,354.3047,1145.4939,358.5701,1151.3082,362.2967,1145.1346,358.0313,1139.3203" style="stroke: #A80036; stroke-width: 1.0;"/><!--link ApplicationImpl to JobQueue--><path d="M450.2137,424.7748 C426.0178,495.5172 388.5529,614.92 371.5,721 C354.2765,828.1417 352.9996,955.2573 353.9991,1026.7817 " fill="none" id="ApplicationImpl-JobQueue" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="454.5693,412.146,448.8316,416.5139,450.6566,423.4902,456.3944,419.1223,454.5693,412.146" style="stroke: #A80036; stroke-width: 1.0;"/><!--link ServerHandlerImpl to JobQueue--><path d="M577.5645,616.0281 C530.7897,641.1355 480.4112,675.9808 447.5,721 C412.0053,769.5531 379.6448,937.8134 364.5131,1026.8058 " fill="none" id="ServerHandlerImpl-JobQueue" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="589.366,609.8544,582.1954,609.0913,578.7331,615.4169,585.9037,616.1799,589.366,609.8544" style="stroke: #A80036; stroke-width: 1.0;"/><!--link JobQueue to Job--><path d="M270.5812,1142.51 C235.3324,1167.212 195.2075,1195.331 162.8939,1217.9759 " fill="none" id="JobQueue-Job" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="281.3499,1134.9635,274.1407,1135.1312,271.5228,1141.8503,278.7319,1141.6826,281.3499,1134.9635" style="stroke: #A80036; stroke-width: 1.0;"/><!--link NetworkOPsImp to JobQueue--><path d="M517.7223,956.232 C486.0462,980.9851 454.1996,1005.8715 427.2139,1026.9595 " fill="none" id="NetworkOPsImp-JobQueue" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="527.9943,948.2049,520.8036,948.7475,518.5389,955.5938,525.7296,955.0511,527.9943,948.2049" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Server to ServerImpl<Handler>--><path d="M1155.5,610.8229 C1155.5,652.8455 1155.5,716.617 1155.5,765.3296 " fill="none" id="Server-ServerImpl&lt;Handler&gt;" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1148.5001,610.7559,1155.5,590.7559,1162.5001,610.7559,1148.5001,610.7559" style="stroke: #A80036; stroke-width: 1.0;"/><!--link InfoSub::Source to NetworkOPs--><path d="M886.7716,1298.9132 C853.6595,1328.9979 808.3756,1370.1416 780.0416,1395.8851 " fill="none" id="InfoSub::Source-NetworkOPs" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="882.4114,1293.417,901.9213,1285.1487,891.8259,1303.7789,882.4114,1293.417" style="stroke: #A80036; stroke-width: 1.0;"/><!--link NetworkOPs to NetworkOPsImp--><path d="M689.5405,1384.8831 C660.6253,1365.2477 629.4216,1337.8689 613.5,1304 C560.3623,1190.9635 591.4779,1046.6407 625.5292,948.034 " fill="none" id="NetworkOPs-NetworkOPsImp" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="693.5552,1379.1416,706.6281,1395.8179,686.009,1390.9338,693.5552,1379.1416" style="stroke: #A80036; stroke-width: 1.0;"/><!--link InfoSub to WSInfoSub--><path d="M730.036,1165.5846 C729.9215,1185.9733 729.8044,1206.8135 729.709,1223.795 " fill="none" id="InfoSub-WSInfoSub" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="723.0365,1165.4662,730.1488,1145.5058,737.0363,1165.5449,723.0365,1165.4662" style="stroke: #A80036; stroke-width: 1.0;"/><!--link NetworkOPsImp to InfoSub--><path d="M702.5204,961.0186 C707.2443,981.6133 711.9492,1002.125 716.1156,1020.2892 " fill="none" id="NetworkOPsImp-InfoSub" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="699.5812,948.2049,697.0239,954.9473,702.2641,959.9011,704.8214,953.1587,699.5812,948.2049" style="stroke: #A80036; stroke-width: 1.0;"/><!--link InfoSub to InfoSub::Source--><path d="M809.9957,1154.4659 C842.4649,1183.6553 877.8486,1215.4649 901.4189,1236.6543 " fill="none" id="InfoSub-InfoSub::Source" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="800.029,1145.5058,801.8168,1152.4918,808.953,1153.5284,807.1652,1146.5424,800.029,1145.5058" style="stroke: #A80036; stroke-width: 1.0;"/><!--link ApplicationImpl to NetworkOPsImp--><path d="M488.941,424.6036 C506.1539,486.0072 535.6504,581.9693 571.5,661 C580.4493,680.7287 591.0465,701.0779 601.9686,720.5899 " fill="none" id="ApplicationImpl-NetworkOPsImp" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="485.4566,412.0438,483.2062,418.8948,488.6647,423.607,490.915,416.7561,485.4566,412.0438" style="stroke: #A80036; stroke-width: 1.0;"/><!--link ServerHandlerImpl to NetworkOPsImp--><path d="M686.624,674.6255 C685.3721,689.8763 684.082,705.5919 682.822,720.941 " fill="none" id="ServerHandlerImpl-NetworkOPsImp" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="687.7127,661.3639,683.2352,667.0165,686.7309,673.3237,691.2084,667.671,687.7127,661.3639" style="stroke: #A80036; stroke-width: 1.0;"/><!--link ApplicationImpl to ServerHandlerImpl--><path d="M536.7236,421.2516 C554.0283,437.0819 573.1974,454.6178 592.0575,471.871 " fill="none" id="ApplicationImpl-ServerHandlerImpl" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="526.7668,412.1432,528.4939,419.1444,535.6208,420.243,533.8937,413.2417,526.7668,412.1432" style="stroke: #A80036; stroke-width: 1.0;"/><!--link ServerHandlerImpl to ServerImpl<Handler>--><path d="M812.9121,634.9053 C881.6069,674.9275 968.0887,725.3125 1036.9743,765.4459 " fill="none" id="ServerHandlerImpl-ServerImpl&lt;Handler&gt;" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="801.6109,628.3211,804.7816,634.7977,811.9795,634.362,808.8088,627.8853,801.6109,628.3211" style="stroke: #A80036; stroke-width: 1.0;"/><!--link ServerImpl<Handler> to Door<Handler>--><path d="M1167.4364,916.894 C1171.9819,948.2707 1177.1115,983.6797 1181.4634,1013.7196 " fill="none" id="ServerImpl&lt;Handler&gt;-Door&lt;Handler&gt;" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1165.528,903.7211,1162.4296,910.2326,1167.2486,915.5971,1170.347,909.0856,1165.528,903.7211" style="stroke: #A80036; stroke-width: 1.0;"/><!--link io_list::work to Door<Handler>--><path d="M1590.4051,870.1899 C1522.6146,904.8763 1417.1246,959.3008 1326.5,1008 C1320.4775,1011.2363 1314.3154,1014.572 1308.1011,1017.9553 " fill="none" id="io_list::work-Door&lt;Handler&gt;" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1587.4875,863.8198,1608.4821,860.9511,1593.8588,876.2861,1587.4875,863.8198" style="stroke: #A80036; stroke-width: 1.0;"/><!--link io_list::work to Door<Handler>::Detector--><path d="M1617.4219,893.9718 C1592.6641,928.1512 1561.33,971.4097 1534.8865,1007.9164 " fill="none" id="io_list::work-Door&lt;Handler&gt;::Detector" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1611.9504,889.5926,1629.3519,877.5017,1623.2885,897.8053,1611.9504,889.5926" style="stroke: #A80036; stroke-width: 1.0;"/><!--link ServerImpl<Handler> to io_list--><path d="M1314.4814,891.8608 C1407.9751,925.6197 1528.477,969.1755 1635.5,1008 C1658.1302,1016.2095 1682.1529,1024.9406 1705.4986,1033.4345 " fill="none" id="ServerImpl&lt;Handler&gt;-io_list" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1302.0553,887.3743,1306.3403,893.1742,1313.3421,891.4495,1309.0571,885.6496,1302.0553,887.3743" style="stroke: #A80036; stroke-width: 1.0;"/><!--link io_list::work to io_list--><path d="M1699.5177,888.0685 C1728.3264,927.6207 1767.564,981.4912 1797.4907,1022.5784 " fill="none" id="io_list::work-io_list" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1805.2764,1033.2677,1804.9771,1026.0628,1798.2114,1023.568,1798.5106,1030.7728,1805.2764,1033.2677" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1691.8212,877.5017,1692.1204,884.7066,1698.8862,887.2015,1698.587,879.9966,1691.8212,877.5017" style="stroke: #A80036; stroke-width: 1.0;"/><!--link ServerImpl<Handler> to N1--><path d="M1105.2324,903.5047 C1062.7718,970.9293 1015.1024,1075.2112 1057.5,1158 C1080.5811,1203.07 1133.5848,1232.9139 1168.1755,1248.382 " fill="none" id="ServerImpl&lt;Handler&gt;-N1" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><!--link Door<Handler> to N1--><path d="M1194.9925,1152.0742 C1196.801,1187.8411 1198.8382,1228.1338 1199.8531,1248.2048 " fill="none" id="Door&lt;Handler&gt;-N1" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><!--link Door<Handler>::Detector to N1--><path d="M1362.1606,1158.23 C1308.429,1192.388 1250.3349,1229.3192 1220.5772,1248.2366 " fill="none" id="Door&lt;Handler&gt;::Detector-N1" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><!--link io_list to N2--><path d="M1875.2052,1132.5829 C1899.54,1168.3812 1931.1227,1214.8417 1948.8586,1240.9325 " fill="none" id="io_list-N2" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><!--link io_list::work to N2--><path d="M1712.8082,840.1825 C1800.085,852.7986 1973.2405,891.9054 2048.5,1008 C2084.7641,1063.9407 2071.2249,1095.3261 2048.5,1158 C2036.3505,1191.5076 2008.0048,1221.7541 1987.1622,1240.6687 " fill="none" id="io_list::work-N2" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><!--
@startuml

class BasicApp {
std::vector<std::thread> threads_
boost::asio::io_service io_service_
}

'abstract class Application

/'class RootStoppable {

}'/

class ApplicationImpl {
std::unique_ptr<JobQueue> m_jobQueue
std::unique_ptr<NetworkOPs> m_networkOPs
std::unique_ptr<ServerHandler> m_serverHandler
void setup()
}

'Application   <|- -   ApplicationImpl
BasicApp      <|- -   ApplicationImpl
'RootStoppable <|- -   ApplicationImpl

abstract class ServerHandler

ServerHandler <|- - ServerHandlerImpl

class ServerHandlerImpl {
NetworkOPs& m_networkOPs
JobQueue& m_jobQueue
std::unique_ptr<Server> m_server
setup()
onAccept()
onHandoff()
onRequest()
onWSMessage()
processSession()
processRequest()
onStop()
}

abstract class Server

class Stoppable {

setParent(Stoppable&)
onStart()
onStopped()
onChildrenStopped()
}

class RootStoppable {

start()
stop()
stopAsync()
}

Stoppable <|- - RootStoppable

RootStoppable <|- - ApplicationImpl

Stoppable <|- - ServerHandlerImpl
Stoppable <|- - "InfoSub::Source"
Stoppable <|- - JobQueue

class JobQueue {
Workers m_workers
std::set<Job> m_jobSet
setThreadCount()
addJob()
postCoro()
}

class Job {
doJob()
JobType mType
std::function<void(Job&)> mJob

}

class Worker {
std:thread thread_
std::mutex mutex_
std::condition_variable wakeup_

notify()
run()
}

class Workers {
beast::LockFreeStack<Worker> m_everyone
semaphore m_semaphore
addTask()
}

Workers *- - Worker
JobQueue *- - Workers
ApplicationImpl *- - JobQueue
ServerHandlerImpl *- - JobQueue
JobQueue *- - Job
NetworkOPsImp *- - JobQueue


Server <|- - "ServerImpl<Handler>"

class "ServerImpl<Handler>" {
boost::asio::io_service& io_service_
boost::asio::io_service::strand strand_
Handler& handler_
std::vector<std::weak_ptr<Door<Handler>> list_
io_list ios_
ports()
close()
}

class io_list {
boost::container::flat_map<work*, std::weak_ptr<work>> map_

emplace()
close()
join()
}

class "io_list::work" {
io_list* ios_

io_list& ios()
close() = 0
}

class "Door<Handler>" {
boost::asio::io_service& ioc_
boost::asio::io_service::strand strand_
Handler& handler_
boost::asio:ip::tcp::acceptor acceptor_
run()
close()
do_accept()
}

class "Door<Handler>::Detector" {
boost::asio::io_service& ioc_
boost::asio::io_service::strand& strand_
Handler& handler_
boost::asio::ip::tcp::socket socket_
boost::asio::ip::tcp::endpoint remote_address
run()
close()
do_detect()
}

abstract class NetworkOPs

class NetworkOPsImp {

using SubMapType = hash_map<std::uint64_t,std::weak_ptr<InfoSub>

std::array<SubMapType,8> mStreamMaps
hash_map<AccountID, SubMapType> mSubAccount
hash_map<AccountID, SubMapType> mSubRTAccount

processTransaction()

pubLedger()
pubValidatedTransaction()
pubAccountTransaction()

subLedger(std::shared_ptr<InfoSub>)
unsubLedger(std::uint64_t)

subTransactions(std::shared_ptr<InfoSub>)
unsubTransactions(std::uint64_t)

subAccount(std::shared_ptr<InfoSub>, hash_set<AccountID>)
unsubAccount(std::shared_ptr<InfoSub>, hash_set<AccountID>)
}

class InfoSub {
std::uint64_t getSeq()
static std::uint64_t assign_id()
insertSubAccountInfo(AccountID)
deleteSubAccountInfo(AccountID)
send() = 0
InfoSub::Source& m_source
}

abstract class "InfoSub::Source"

class WSInfoSub {
std::weak_ptr<WSSession> ws_

send()
}


"InfoSub::Source" <|- - NetworkOPs
NetworkOPs <|- - NetworkOPsImp

InfoSub <|- - WSInfoSub
NetworkOPsImp *- - InfoSub
InfoSub *- - "InfoSub::Source"

ApplicationImpl *- - NetworkOPsImp
ServerHandlerImpl *- - NetworkOPsImp


ApplicationImpl *- - ServerHandlerImpl
ServerHandlerImpl *- - "ServerImpl<Handler>"
"ServerImpl<Handler>" *- - "Door<Handler>"
"io_list::work" <|- - "Door<Handler>"
"io_list::work" <|- - "Door<Handler>::Detector"
"ServerImpl<Handler>" *- - io_list
"io_list::work" *- -* io_list

note "Handler template parameter is ServerHandlerImpl" as N1

"ServerImpl<Handler>" .. N1
"Door<Handler>" .. N1
"Door<Handler>::Detector" .. N1

note as N2
io_list keeps a collection of pointers to io_list::work objects,
while the io_list::work objects have a pointer to the containing io_list object
end note

io_list .. N2
"io_list::work" .. N2

@enduml

PlantUML version 1.2017.15(Mon Jul 03 09:45:34 PDT 2017)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.5+10-post-Ubuntu-0ubuntu1.118.04
Operating System: Linux
OS Version: 5.3.2-050302-generic
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>