<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>rippled: CanProcess Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">rippled
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classCanProcess-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">CanProcess Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>RAII class to check if an Item is already being processed on another thread, as indicated by it's presence in a Collection.  
 <a href="classCanProcess.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="CanProcess_8h_source.html">CanProcess.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for CanProcess:</div>
<div class="dyncontent">
<div class="center"><img src="classCanProcess__coll__graph.png" border="0" usemap="#aCanProcess_coll__map" alt="Collaboration graph"/></div>
<map name="aCanProcess_coll__map" id="aCanProcess_coll__map">
<area shape="rect" title="RAII class to check if an Item is already being processed on another thread, as indicated by it&#39;s pre..." alt="" coords="40,93,137,119"/>
<area shape="rect" target="_parent" href="http://en.cppreference.com/w/cpp/utility/functional/function.html" title=" " alt="" coords="5,5,172,31"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a08452f2b7beb21dfeae3b6060084c15c"><td class="memTemplParams" colspan="2">template&lt;class Mutex , class Collection , class Item &gt; </td></tr>
<tr class="memitem:a08452f2b7beb21dfeae3b6060084c15c"><td class="memTemplItemLeft" align="right" valign="top">&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classCanProcess.html#a08452f2b7beb21dfeae3b6060084c15c">CanProcess</a> (Mutex &amp;mtx, Collection &amp;collection, Item const &amp;item)</td></tr>
<tr class="separator:a08452f2b7beb21dfeae3b6060084c15c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf16b132d54ce14414da4c391be607ea"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCanProcess.html#acf16b132d54ce14414da4c391be607ea">~CanProcess</a> ()</td></tr>
<tr class="separator:acf16b132d54ce14414da4c391be607ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7486a1e167e4ae9f3c598e442a2f6c5e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCanProcess.html#a7486a1e167e4ae9f3c598e442a2f6c5e">operator bool</a> () const</td></tr>
<tr class="separator:a7486a1e167e4ae9f3c598e442a2f6c5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:aa2f7a7106e39f0d3551e2935553cf7ab"><td class="memTemplParams" colspan="2">template&lt;bool useIterator, class Mutex , class Collection , class Item &gt; </td></tr>
<tr class="memitem:aa2f7a7106e39f0d3551e2935553cf7ab"><td class="memTemplItemLeft" align="right" valign="top"><a class="elRef" href="http://en.cppreference.com/w/cpp/utility/functional/function.html">std::function</a>&lt; void()&gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classCanProcess.html#aa2f7a7106e39f0d3551e2935553cf7ab">doInsert</a> (Mutex &amp;mtx, Collection &amp;collection, Item const &amp;item)</td></tr>
<tr class="separator:aa2f7a7106e39f0d3551e2935553cf7ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72c16129f006882f0eea5a8b6699830b"><td class="memTemplParams" colspan="2">template&lt;class Mutex , class Collection , class Item &gt; </td></tr>
<tr class="memitem:a72c16129f006882f0eea5a8b6699830b"><td class="memTemplItemLeft" align="right" valign="top"><a class="elRef" href="http://en.cppreference.com/w/cpp/utility/functional/function.html">std::function</a>&lt; void()&gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classCanProcess.html#a72c16129f006882f0eea5a8b6699830b">insert</a> (Mutex &amp;mtx, Collection &amp;collection, Item const &amp;item)</td></tr>
<tr class="separator:a72c16129f006882f0eea5a8b6699830b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2057b4c136763f0595c766f6095e2814"><td class="memTemplParams" colspan="2">template&lt;class Mutex , class Item &gt; </td></tr>
<tr class="memitem:a2057b4c136763f0595c766f6095e2814"><td class="memTemplItemLeft" align="right" valign="top"><a class="elRef" href="http://en.cppreference.com/w/cpp/utility/functional/function.html">std::function</a>&lt; void()&gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classCanProcess.html#a2057b4c136763f0595c766f6095e2814">insert</a> (Mutex &amp;mtx, <a class="elRef" href="http://en.cppreference.com/w/cpp/container/set.html">std::set</a>&lt; Item &gt; &amp;collection, Item const &amp;item)</td></tr>
<tr class="separator:a2057b4c136763f0595c766f6095e2814"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a5c6ff8ef90f52d0aa514dda7a1c60583"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="http://en.cppreference.com/w/cpp/utility/functional/function.html">std::function</a>&lt; void()&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCanProcess.html#a5c6ff8ef90f52d0aa514dda7a1c60583">cleanup_</a></td></tr>
<tr class="separator:a5c6ff8ef90f52d0aa514dda7a1c60583"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >RAII class to check if an Item is already being processed on another thread, as indicated by it's presence in a Collection. </p>
<p >If the Item is not in the Collection, it will be added under lock in the ctor, and removed under lock in the dtor. The object will be considered "usable" and evaluate to <code>true</code>.</p>
<p >If the Item is in the Collection, no changes will be made to the collection, and the <a class="el" href="classCanProcess.html" title="RAII class to check if an Item is already being processed on another thread, as indicated by it&#39;s pre...">CanProcess</a> object will be considered "unusable".</p>
<p >It's up to the caller to decide what "usable" and "unusable" mean. (e.g. Process or skip a block of code, or set a flag.)</p>
<p >The current use is to avoid lock contention that would be involved in processing something associated with the Item.</p>
<p >Examples:</p>
<p >void IncomingLedgers::acquireAsync(LedgerHash const&amp; hash, ...) { if (<a class="el" href="classCanProcess.html" title="RAII class to check if an Item is already being processed on another thread, as indicated by it&#39;s pre...">CanProcess</a> check{acquiresMutex_, pendingAcquires_, hash}) { acquire(hash, ...); } }</p>
<p >bool NetworkOPsImp::recvValidation(
  std::shared_ptr&lt;STValidation&gt; const&amp; val,
  std::string const&amp; source) { <a class="el" href="classCanProcess.html" title="RAII class to check if an Item is already being processed on another thread, as indicated by it&#39;s pre...">CanProcess</a> check( validationsMutex_, pendingValidations_, val-&gt;getLedgerHash()); BypassAccept bypassAccept = check ? BypassAccept::no : BypassAccept::yes; handleNewValidation(app_, val, source, bypassAccept, m_journal); } </p>

<p class="definition">Definition at line <a class="el" href="CanProcess_8h_source.html#l00066">66</a> of file <a class="el" href="CanProcess_8h_source.html">CanProcess.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a08452f2b7beb21dfeae3b6060084c15c" name="a08452f2b7beb21dfeae3b6060084c15c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08452f2b7beb21dfeae3b6060084c15c">&#9670;&#160;</a></span>CanProcess()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Mutex , class Collection , class Item &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">CanProcess::CanProcess </td>
          <td>(</td>
          <td class="paramtype">Mutex &amp;&#160;</td>
          <td class="paramname"><em>mtx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Collection &amp;&#160;</td>
          <td class="paramname"><em>collection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Item const &amp;&#160;</td>
          <td class="paramname"><em>item</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CanProcess_8h_source.html#l00070">70</a> of file <a class="el" href="CanProcess_8h_source.html">CanProcess.h</a>.</p>

</div>
</div>
<a id="acf16b132d54ce14414da4c391be607ea" name="acf16b132d54ce14414da4c391be607ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf16b132d54ce14414da4c391be607ea">&#9670;&#160;</a></span>~CanProcess()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CanProcess::~CanProcess </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CanProcess_8h_source.html#l00075">75</a> of file <a class="el" href="CanProcess_8h_source.html">CanProcess.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a7486a1e167e4ae9f3c598e442a2f6c5e" name="a7486a1e167e4ae9f3c598e442a2f6c5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7486a1e167e4ae9f3c598e442a2f6c5e">&#9670;&#160;</a></span>operator bool()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CanProcess::operator bool </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CanProcess_8h_source.html#l00082">82</a> of file <a class="el" href="CanProcess_8h_source.html">CanProcess.h</a>.</p>

</div>
</div>
<a id="aa2f7a7106e39f0d3551e2935553cf7ab" name="aa2f7a7106e39f0d3551e2935553cf7ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2f7a7106e39f0d3551e2935553cf7ab">&#9670;&#160;</a></span>doInsert()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;bool useIterator, class Mutex , class Collection , class Item &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="http://en.cppreference.com/w/cpp/utility/functional/function.html">std::function</a>&lt; void()&gt; CanProcess::doInsert </td>
          <td>(</td>
          <td class="paramtype">Mutex &amp;&#160;</td>
          <td class="paramname"><em>mtx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Collection &amp;&#160;</td>
          <td class="paramname"><em>collection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Item const &amp;&#160;</td>
          <td class="paramname"><em>item</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CanProcess_8h_source.html#l00090">90</a> of file <a class="el" href="CanProcess_8h_source.html">CanProcess.h</a>.</p>

</div>
</div>
<a id="a72c16129f006882f0eea5a8b6699830b" name="a72c16129f006882f0eea5a8b6699830b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72c16129f006882f0eea5a8b6699830b">&#9670;&#160;</a></span>insert() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Mutex , class Collection , class Item &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="http://en.cppreference.com/w/cpp/utility/functional/function.html">std::function</a>&lt; void()&gt; CanProcess::insert </td>
          <td>(</td>
          <td class="paramtype">Mutex &amp;&#160;</td>
          <td class="paramname"><em>mtx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Collection &amp;&#160;</td>
          <td class="paramname"><em>collection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Item const &amp;&#160;</td>
          <td class="paramname"><em>item</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CanProcess_8h_source.html#l00116">116</a> of file <a class="el" href="CanProcess_8h_source.html">CanProcess.h</a>.</p>

</div>
</div>
<a id="a2057b4c136763f0595c766f6095e2814" name="a2057b4c136763f0595c766f6095e2814"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2057b4c136763f0595c766f6095e2814">&#9670;&#160;</a></span>insert() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Mutex , class Item &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="http://en.cppreference.com/w/cpp/utility/functional/function.html">std::function</a>&lt; void()&gt; CanProcess::insert </td>
          <td>(</td>
          <td class="paramtype">Mutex &amp;&#160;</td>
          <td class="paramname"><em>mtx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="elRef" href="http://en.cppreference.com/w/cpp/container/set.html">std::set</a>&lt; Item &gt; &amp;&#160;</td>
          <td class="paramname"><em>collection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Item const &amp;&#160;</td>
          <td class="paramname"><em>item</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CanProcess_8h_source.html#l00125">125</a> of file <a class="el" href="CanProcess_8h_source.html">CanProcess.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a5c6ff8ef90f52d0aa514dda7a1c60583" name="a5c6ff8ef90f52d0aa514dda7a1c60583"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c6ff8ef90f52d0aa514dda7a1c60583">&#9670;&#160;</a></span>cleanup_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="http://en.cppreference.com/w/cpp/utility/functional/function.html">std::function</a>&lt;void()&gt; CanProcess::cleanup_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="CanProcess_8h_source.html#l00131">131</a> of file <a class="el" href="CanProcess_8h_source.html">CanProcess.h</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
